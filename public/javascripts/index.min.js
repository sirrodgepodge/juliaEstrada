/*! cafeJefe 2016-01-08 */
function listeners() {
    landingScroll(), $(window).resize(function() {
        console.log("landingHeadFixPoint", landingHeadFixPoint), console.log("titleTop", titleTop), 
        titleTop = Math.ceil($landing.outerHeight()), landingHeadFixPoint = titleTop - Math.ceil($landingHead.position().top), 
        downAnimReached = .395 * titleTop + 4.5, contactTop = .9 * Math.ceil($contact.offset().top), 
        landingScroll();
    }), window.addEventListener("scroll", landingScroll);
}

function landingScroll() {
    pagePos = window.pageYOffset, !landingTogglerClicked && (pagePos >= landingHeadFixPoint && !landingHeadFixed || landingHeadFixPoint > pagePos && landingHeadFixed) && ($landingHead.toggleClass("hide"), 
    $title.toggleClass("show-logo"), landingHeadFixed = !landingHeadFixed), (pagePos >= titleTop && !titleFixed || titleTop > pagePos && titleFixed) && ($title.toggleClass("sticky"), 
    $placeHolder.toggleClass("no-show"), titleFixed = !titleFixed), (pagePos >= contactTop && !contactPopped || contactTop > pagePos && contactPopped) && ($contact.toggleClass("poppin"), 
    contactPopped = !contactPopped), downAnimReached > pagePos && !topTextShowing && (topTextShowing = !0), 
    0 === pagePos ? $landingContent.add($downAnim).css("opacity", 1) : pagePos >= downAnimReached && topTextShowing ? $landingContent.add($downAnim).css("opacity", +(topTextShowing = !1)) : pagePos > 0 && downAnimReached > pagePos && $landingContent.add($downAnim).css("opacity", 1 - pagePos / downAnimReached);
}

var $purchaseToggle = $(".purchase-toggle"), $coffeeInd = $(".coffee-ind"), $buyBtn = $(".buy-btn"), $coffeePrice = $(".coffee-price"), $merchIndBack = $(".merch-ind .back"), $size = $merchIndBack.children(".size"), $backToTop = $(".back-to-top, .title, .footer-logo"), $title = $(".title"), $contact = $(".contact"), $placeHolder = $(".place-holder"), $landingHead = $(".landing-head"), $landing = $(".landing"), $landingContent = $landing.find(".landing-content").children(), $landingTogglers = $landing.find(".landing-tab"), $downAnim = $landing.find(".down-anim"), $contactImg = $(".contact-img"), $contactSub = $(".contact-sub"), $contactSubInside = $contactSub.find(".contact-sub-inside"), coffee = [], merch = [], contact = {};

$.get("/api/info", function(data) {
    coffee = data.coffee.product, merch = data.merch, contact = data.contact;
});

var landingTogglerClicked = !1, main = function() {
    $landingTogglers.click(function() {
        var notSelImg, tempThis;
        if (!$(this).hasClass("landing-active")) if ($landingHead.hasClass("fade-out")) {
            var $startLandingActive = $(".landing-active");
            $startLandingActive.toggleClass("landing-active"), $startLandingActive.children(".full").toggleClass("show"), 
            $(this).toggleClass("landing-active"), tempThis = this, notSelImg = $(".landing-img").not(".show"), 
            $(".landing-img.show").toggleClass("show"), setTimeout(function() {
                $(tempThis).children(".full").toggleClass("show"), notSelImg.toggleClass("show");
            }, 400);
        } else $landingHead.addClass("fade-out"), landingTogglerClicked = !landingTogglerClicked && !!$title.addClass("show-logo"), 
        $(this).toggleClass("landing-active"), tempThis = this, $(this).hasClass("tab-2") ? (notSelImg = $(".landing-img").not(".show"), 
        $(".landing-img.show").toggleClass("show"), setTimeout(function() {
            $(tempThis).children(".full").toggleClass("show"), notSelImg.toggleClass("show");
        }, 400)) : setTimeout(function() {
            $(tempThis).children(".full").toggleClass("show");
        }, 400);
    }), $downAnim.click(function() {
        $("html, body").animate({
            scrollTop: titleTop
        }, titleTop - .8 * $(window).scrollTop());
    });
    var purchTypeVal = $(".active-purch-type").attr("id");
    $purchaseToggle.click(function() {
        $(this).hasClass("active-purch-type") || ($purchaseToggle.each(function() {
            $(this).toggleClass("active-purch-type");
        }), purchTypeVal = $(this).attr("id"), $buyBtn.find(".button-text").html(purchTypeVal.slice(0, 1).toUpperCase() + purchTypeVal.slice(1)), 
        $coffeePrice.each(function(index, val) {
            $(this).html("$" + coffee[index][purchTypeVal]);
            var currVal = $($buyBtn[index]).attr("href").slice(0, $($buyBtn[index]).attr("href").lastIndexOf("-") + 1);
            $($buyBtn[index]).attr("href", currVal + purchTypeVal);
        }));
    }), $coffeeInd.click(function() {
        $(this).hasClass("active-coffee-amount") || ($(".active-coffee-amount").toggleClass("active-coffee-amount"), 
        $(this).children(".coffee-ind-inside").toggleClass("active-coffee-amount"));
    }), $size.mouseenter(function() {
        $(this).parent().children(".t-shirt").first().attr("data-size", $(this).text()), 
        $(this).hasClass("active") || ($(this).parent().children(".size.active").toggleClass("active"), 
        $(this).toggleClass("active"));
        var buyMerchBtn = $(this).parent().children(".buy-merch").first();
        buyMerchBtn.attr("href", buyMerchBtn.attr("href").slice(0, buyMerchBtn.attr("href").lastIndexOf("_") + 1) + $(this).text());
    });
    var slideSwitchText = function(val) {
        $contactSubInside.toggleClass("show"), setTimeout(function() {
            $contactSubInside.text(val), $contactSubInside.toggleClass("show"), $contactSub.innerWidth($contactSubInside.width());
        }, 525);
    };
    $contactSub.innerWidth($contactSubInside.width()), $contactImg.mouseenter(function() {
        var selected = $(this).attr("class").split(" ")[1];
        $contactSubInside.text() !== contact[selected].text && ($contactSub.attr("href", contact[selected].link), 
        !!contact[selected].link === $contactSub.hasClass("disable-link") && $contactSub.toggleClass("disable-link"), 
        slideSwitchText(contact[selected].text));
    }), $backToTop.click(function() {
        $("html, body").animate({
            scrollTop: 0
        }, 1.5 * $(window).scrollTop());
    });
}, titleTop = Math.ceil($landing.outerHeight()), landingHeadFixPoint = titleTop - Math.ceil($landingHead.position().top), contactTop = .92 * Math.ceil($contact.offset().top), downAnimReached = .395 * titleTop + 4.5, pagePos = 0, titleFixed = !1, landingHeadFixed = !1, topTextShowing = !0, contactPopped = !1;

$(document).ready(main, listeners());